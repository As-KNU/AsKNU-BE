#!/bin/bash
# ë¹ ë¥¸ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸

echo "ğŸš€ AsKNU Backend - Render ë°°í¬ ê°€ì´ë“œ"
echo "======================================"
echo ""

# í˜„ì¬ ìƒíƒœ í™•ì¸
echo "ğŸ“Š 1. í˜„ì¬ ìƒíƒœ"
echo "   ë¸Œëœì¹˜: $(git branch --show-current)"
echo "   ìµœê·¼ ì»¤ë°‹: $(git log --oneline -1)"
echo ""

# GitHub í‘¸ì‹œ
echo "ğŸ“¤ 2. GitHubì— í‘¸ì‹œ"
echo "   ëª…ë ¹ì–´: git push origin $(git branch --show-current)"
read -p "   ì§€ê¸ˆ í‘¸ì‹œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/n): " push_confirm
if [ "$push_confirm" = "y" ]; then
    git push origin $(git branch --show-current)
    echo "   âœ… í‘¸ì‹œ ì™„ë£Œ!"
else
    echo "   â­ï¸  ê±´ë„ˆë›°ê¸°"
fi
echo ""

# Render ë°°í¬ ì•ˆë‚´
echo "ğŸŒ 3. Render ë°°í¬ ë‹¨ê³„"
echo "======================================"
echo ""
echo "Step 1: Render ì ‘ì†"
echo "  â†’ https://render.com ë°©ë¬¸"
echo "  â†’ GitHub ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸"
echo ""
echo "Step 2: ìƒˆ Web Service ìƒì„±"
echo "  â†’ 'New +' ë²„íŠ¼ í´ë¦­"
echo "  â†’ 'Web Service' ì„ íƒ"
echo "  â†’ GitHub ë¦¬í¬ì§€í† ë¦¬ ì—°ê²°"
echo ""
echo "Step 3: ê¸°ë³¸ ì„¤ì •"
echo "  Name: asknu-backend"
echo "  Region: Singapore (ë˜ëŠ” Oregon)"
echo "  Branch: $(git branch --show-current)"
echo "  Runtime: Python 3"
echo "  Build Command: pip install -r requirements.txt"
echo "  Start Command: uvicorn main:app --host 0.0.0.0 --port \$PORT"
echo ""
echo "Step 4: í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (Environment íƒ­)"
echo "======================================"
echo "  ë‹¤ìŒ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì¶”ê°€í•˜ì„¸ìš”:"
echo ""
echo "  DATABASE_URL (í•„ìˆ˜)"
echo "  ê°’: $(grep DATABASE_URL .env 2>/dev/null | cut -d'=' -f2-)"
echo ""
echo "  UPSTAGE_API_KEY (í•„ìˆ˜)"
echo "  ê°’: $(grep UPSTAGE_API_KEY .env 2>/dev/null | cut -d'=' -f2-)"
echo ""
echo "  UPSTAGE_MODEL"
echo "  ê°’: solar-pro"
echo ""
echo "  BASE_BOARD"
echo "  ê°’: https://cse.knu.ac.kr/bbs/board.php?bo_table=sub5_1&lang=kor"
echo ""
echo "======================================"
echo ""
echo "Step 5: í”Œëœ ì„ íƒ"
echo "  â­• Free Plan (ë¬´ë£Œ, ìŠ¬ë¦½ ëª¨ë“œ ìˆìŒ)"
echo "  â­• Starter Plan ($7/ì›”, í•­ìƒ í™œì„±)"
echo ""
echo "Step 6: Deploy ë²„íŠ¼ í´ë¦­!"
echo "  â†’ ìë™ ë°°í¬ ì‹œì‘"
echo "  â†’ ë¡œê·¸ ì‹¤ì‹œê°„ í™•ì¸ ê°€ëŠ¥"
echo "  â†’ ì™„ë£Œë˜ë©´ URL ìƒì„±"
echo ""
echo "======================================"
echo "ğŸ‰ ë°°í¬ ì™„ë£Œ í›„ í…ŒìŠ¤íŠ¸"
echo "======================================"
echo ""
echo "1. í—¬ìŠ¤ì²´í¬:"
echo "   curl https://your-app.onrender.com/health"
echo ""
echo "2. API ë¬¸ì„œ:"
echo "   https://your-app.onrender.com/docs"
echo ""
echo "3. ì±—ë´‡ í…ŒìŠ¤íŠ¸:"
echo "   curl -X POST https://your-app.onrender.com/chat \\"
echo "     -H 'Content-Type: application/json' \\"
echo "     -d '{\"question\": \"ê²½ì§„ëŒ€íšŒ ì•Œë ¤ì¤˜\"}'"
echo ""
echo "======================================"
echo "ğŸ“š ìƒì„¸ ê°€ì´ë“œ: DEPLOYMENT.md"
echo "ğŸ†˜ ë¬¸ì œ ë°œìƒì‹œ: Render ëŒ€ì‹œë³´ë“œ Logs í™•ì¸"
echo "======================================"
echo ""
echo "âœ¨ ë°°í¬ ì„±ê³µì„ ê¸°ì›í•©ë‹ˆë‹¤! ğŸš€"
